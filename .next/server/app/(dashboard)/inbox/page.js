(()=>{var e={};e.id=3624,e.ids=[3624],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1336:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>d}),s(6637),s(3028),s(5866),s(2029);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["(dashboard)",{children:["inbox",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6637)),"/Users/tezferguson/gitProjects/onitsocial/src/app/(dashboard)/inbox/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3028)),"/Users/tezferguson/gitProjects/onitsocial/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"/Users/tezferguson/gitProjects/onitsocial/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/tezferguson/gitProjects/onitsocial/src/app/(dashboard)/inbox/page.tsx"],u="/(dashboard)/inbox/page",m={require:s,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/inbox/page",pathname:"/inbox",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8588:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},9866:(e,t,s)=>{Promise.resolve().then(s.bind(s,802))},4652:(e,t,s)=>{Promise.resolve().then(s.bind(s,2224))},8370:()=>{},5578:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var r=s(7577);let a=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),i=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},c=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:n="",children:i,iconNode:c,...u},m)=>(0,r.createElement)("svg",{ref:m,...o,width:t,height:t,stroke:e,strokeWidth:l?24*Number(s)/Number(t):s,className:a("lucide",n),...!i&&!d(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),u=(e,t)=>{let s=(0,r.forwardRef)(({className:s,...n},o)=>(0,r.createElement)(c,{ref:o,iconNode:t,className:a(`lucide-${l(i(e))}`,`lucide-${e}`,s),...n}));return s.displayName=i(e),s}},2933:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5578).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},617:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5578).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},1405:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5578).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},802:(e,t,s)=>{"use strict";s.d(t,{DashboardLayoutClient:()=>n});var r=s(326);s(7577);var a=s(2580),l=s(5436);function n({children:e,user:t,brands:s,accounts:n}){(0,a.L)(e=>e.setUser);let{setBrands:i,setActiveBrand:o,setAccounts:d}=(0,l.o)();return r.jsx(r.Fragment,{children:e})}},2224:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var r=s(326),a=s(7577),l=s(5436),n=s(1223),i=s(3594),o=s(8443),d=s(384),c=s(617),u=s(5578);let m=(0,u.Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),f=(0,u.Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),x={comment:r.jsx(c.Z,{className:"w-4 h-4"}),dm:r.jsx(m,{className:"w-4 h-4"}),review:r.jsx(f,{className:"w-4 h-4"})},h={facebook:"bg-blue-500",instagram:"bg-pink-500",tiktok:"bg-black",youtube:"bg-red-500",linkedin:"bg-blue-700",google_business:"bg-blue-400"};function p({messages:e,selectedId:t,onSelect:s,isLoading:l}){let[c,u]=(0,a.useState)("all"),m="all"===c?e:e.filter(e=>e.type===c);return e.filter(e=>!e.is_read).length,(0,r.jsxs)("div",{className:"flex flex-col h-full bg-white border-r border-slate-200 dark:bg-slate-950 dark:border-slate-800",children:[r.jsx("div",{className:"border-b border-slate-200 dark:border-slate-800 px-4 py-3",children:r.jsx(d.mQ,{defaultValue:"all",value:c,onValueChange:e=>u(e),children:(0,r.jsxs)(d.dr,{className:"grid w-full grid-cols-4",children:[(0,r.jsxs)(d.SP,{value:"all",className:"text-xs",children:["All ",e.length>0&&`(${e.length})`]}),r.jsx(d.SP,{value:"comment",className:"text-xs",children:"Comments"}),r.jsx(d.SP,{value:"dm",className:"text-xs",children:"DMs"}),r.jsx(d.SP,{value:"review",className:"text-xs",children:"Reviews"})]})})}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:l?r.jsx("div",{className:"space-y-2 p-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>r.jsx("div",{className:"h-16 bg-slate-200 dark:bg-slate-800 rounded-lg animate-pulse"},t))}):0===m.length?r.jsx("div",{className:"flex items-center justify-center h-full text-slate-500 dark:text-slate-400 p-4 text-center text-sm",children:"No messages in this filter"}):r.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-800",children:m.map(e=>r.jsx("button",{onClick:()=>s(e.id),className:(0,n.cn)("w-full text-left px-4 py-3 transition-colors hover:bg-slate-50 dark:hover:bg-slate-900",t===e.id?"bg-blue-50 dark:bg-slate-800":""),children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(i.qE,{className:"w-10 h-10 flex-shrink-0",children:[r.jsx(i.F$,{src:e.sender_avatar||void 0}),r.jsx(i.Q5,{className:"text-xs",children:e.sender_name.charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[r.jsx("p",{className:"font-medium text-sm text-slate-900 dark:text-slate-50 truncate",children:e.sender_name}),r.jsx("time",{className:"text-xs text-slate-500 dark:text-slate-400 flex-shrink-0",children:(0,n.SY)(e.received_at)})]}),r.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 truncate line-clamp-1",children:e.content}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx(o.C,{variant:"secondary",className:(0,n.cn)("text-white text-xs py-0.5 px-2",h[e.platform]||"bg-slate-500"),children:e.platform}),x[e.type]&&r.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:x[e.type]}),!e.is_read&&r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full ml-auto flex-shrink-0"})]})]})]})},e.id))})})]})}var b=s(1664),g=s(2015);let v=(0,u.Z)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var j=s(2933);let y=(0,u.Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),k={comment:"Comment",dm:"Direct Message",review:"Review"},N={comment:r.jsx(c.Z,{className:"w-4 h-4"}),dm:r.jsx(m,{className:"w-4 h-4"}),review:r.jsx(f,{className:"w-4 h-4"})},w={facebook:"bg-blue-500",instagram:"bg-pink-500",tiktok:"bg-black",youtube:"bg-red-500",linkedin:"bg-blue-700",google_business:"bg-blue-400"};function _({message:e,onReply:t,onMarkRead:s,onMarkResolved:l,isReplying:d=!1}){let[c,u]=(0,a.useState)(""),[f,x]=(0,a.useState)(!1),h=(0,a.useRef)(null),p=async()=>{if(c.trim()&&t){x(!0);try{await t(c),u("")}finally{x(!1)}}};return e?(0,r.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-slate-950",children:[r.jsx("div",{className:"border-b border-slate-200 dark:border-slate-800 px-6 py-4 flex-shrink-0",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,r.jsxs)(i.qE,{className:"w-12 h-12 flex-shrink-0",children:[r.jsx(i.F$,{src:e.sender_avatar||void 0}),r.jsx(i.Q5,{className:"text-sm",children:e.sender_name.charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-50 truncate",children:e.sender_name}),r.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:(0,n.p6)(e.received_at,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[r.jsx(o.C,{variant:"secondary",className:(0,n.cn)("text-white text-xs py-1 px-2",w[e.platform]||"bg-slate-500"),children:e.platform}),(0,r.jsxs)(o.C,{variant:"secondary",className:"text-xs py-1 px-2",children:[N[e.type],r.jsx("span",{className:"ml-1",children:k[e.type]})]})]})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[r.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:r.jsx("p",{className:"text-slate-700 dark:text-slate-200 whitespace-pre-wrap break-words",children:e.content})}),e.replied_at&&r.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-900",children:(0,r.jsxs)("p",{className:"text-sm text-green-700 dark:text-green-300 flex items-center gap-2",children:[r.jsx(v,{className:"w-4 h-4"}),"Replied ",(0,n.p6)(e.replied_at,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]}),(0,r.jsxs)("div",{className:"border-t border-slate-200 dark:border-slate-800 px-6 py-3 flex gap-2 flex-shrink-0 flex-wrap",children:[(0,r.jsxs)(b.z,{variant:e.is_read?"outline":"default",size:"sm",onClick:()=>s?.(!e.is_read),className:"text-xs",children:[r.jsx(j.Z,{className:"w-4 h-4 mr-1"}),e.is_read?"Mark Unread":"Mark Read"]}),r.jsx(b.z,{variant:e.is_resolved?"default":"outline",size:"sm",onClick:()=>l?.(!e.is_resolved),className:"text-xs",children:e.is_resolved?"Reopen":"Resolve"})]}),!e.replied_at&&(0,r.jsxs)("div",{className:"border-t border-slate-200 dark:border-slate-800 px-6 py-4 flex-shrink-0 bg-slate-50 dark:bg-slate-900",children:[r.jsx("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Reply"}),r.jsx(g.g,{ref:h,placeholder:"Write your reply...",value:c,onChange:e=>u(e.target.value),disabled:f||d,className:"resize-none mb-3",rows:3}),r.jsx("div",{className:"flex justify-end",children:(0,r.jsxs)(b.z,{onClick:p,disabled:!c.trim()||f||d,size:"sm",className:"text-xs",children:[r.jsx(y,{className:"w-4 h-4 mr-1"}),"Send Reply"]})})]})]}):r.jsx("div",{className:"flex items-center justify-center h-full bg-white dark:bg-slate-950",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(m,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-3"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"No message selected"}),r.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-xs mt-1",children:"Select a message from the list to view details"})]})})}var S=s(1190),R=s(143);let C=(0,u.Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var P=s(1405);let E=(0,u.Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),A=[{id:"facebook",label:"Facebook"},{id:"instagram",label:"Instagram"},{id:"tiktok",label:"TikTok"},{id:"youtube",label:"YouTube"},{id:"linkedin",label:"LinkedIn"},{id:"google_business",label:"Google Business"}];function M({onSearch:e,onFilterPlatform:t,onFilterReadStatus:s,onFilterResolved:l,onSync:n,unreadCount:i,isSyncing:d,searchQuery:c,activePlatformFilter:u,activeReadFilter:m,activeResolvedFilter:f}){let[x,h]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[r.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),r.jsx(S.I,{type:"text",placeholder:"Search messages...",value:c,onChange:t=>{h(t.target.value.length>0),e(t.target.value)},className:"pl-9"})]}),r.jsx(b.z,{onClick:n,disabled:d,variant:"outline",size:"sm",className:"flex-shrink-0",children:r.jsx(P.Z,{className:`w-4 h-4 ${d?"animate-spin":""}`})}),i>0&&(0,r.jsxs)(o.C,{variant:"default",className:"ml-2 flex-shrink-0",children:[i," new"]})]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[r.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 font-medium",children:"Filter:"}),(0,r.jsxs)(R.h_,{children:[r.jsx(R.$F,{children:(0,r.jsxs)(b.z,{variant:u?"default":"outline",size:"sm",className:"text-xs",children:[r.jsx(E,{className:"w-3 h-3 mr-1"}),"Platform"]})}),(0,r.jsxs)(R.AW,{children:[r.jsx("div",{className:"px-2 py-1.5 text-sm font-medium",children:"Select Platform"}),r.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-800 my-1"}),r.jsx(R.Xi,{onClick:()=>t(null),children:"All Platforms"}),A.map(e=>(0,r.jsxs)(R.Xi,{onClick:()=>t(e.id),children:[e.label,u===e.id&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]},e.id))]})]}),(0,r.jsxs)(R.h_,{children:[r.jsx(R.$F,{children:(0,r.jsxs)(b.z,{variant:"all"!==m?"default":"outline",size:"sm",className:"text-xs",children:[r.jsx(E,{className:"w-3 h-3 mr-1"}),"Status"]})}),(0,r.jsxs)(R.AW,{children:[r.jsx("div",{className:"px-2 py-1.5 text-sm font-medium",children:"Read Status"}),r.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-800 my-1"}),(0,r.jsxs)(R.Xi,{onClick:()=>s("all"),children:["All Messages","all"===m&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]}),(0,r.jsxs)(R.Xi,{onClick:()=>s("unread"),children:["Unread","unread"===m&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]}),(0,r.jsxs)(R.Xi,{onClick:()=>s("read"),children:["Read","read"===m&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]})]})]}),(0,r.jsxs)(R.h_,{children:[r.jsx(R.$F,{children:(0,r.jsxs)(b.z,{variant:"all"!==f?"default":"outline",size:"sm",className:"text-xs",children:[r.jsx(E,{className:"w-3 h-3 mr-1"}),"Resolution"]})}),(0,r.jsxs)(R.AW,{children:[r.jsx("div",{className:"px-2 py-1.5 text-sm font-medium",children:"Resolution Status"}),r.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-800 my-1"}),(0,r.jsxs)(R.Xi,{onClick:()=>l("all"),children:["All","all"===f&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]}),(0,r.jsxs)(R.Xi,{onClick:()=>l("unresolved"),children:["Unresolved","unresolved"===f&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]}),(0,r.jsxs)(R.Xi,{onClick:()=>l("resolved"),children:["Resolved","resolved"===f&&r.jsx("span",{className:"ml-auto text-blue-600",children:"✓"})]})]})]})]})]})}function T(){let{activeBrandId:e}=(0,l.o)(),[t,s]=(0,a.useState)([]),[n,i]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[f,x]=(0,a.useState)(!1),[h,b]=(0,a.useState)(""),[g,v]=(0,a.useState)(null),[j,y]=(0,a.useState)("all"),[k,N]=(0,a.useState)("all"),w=t.find(e=>e.id===n)||null,S=(0,a.useCallback)(async()=>{if(e){d(!0);try{let t=new URLSearchParams({brand_id:e}),r=await fetch(`/api/inbox?${t}`,{method:"GET"});if(!r.ok){console.error("Failed to fetch messages");return}let a=await r.json();s(a.data||[])}catch(e){console.error("Error fetching messages:",e)}finally{d(!1)}}},[e]),R=(0,a.useCallback)(async()=>{if(e){u(!0);try{(await fetch("/api/inbox/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brand_id:e})})).ok&&await S()}catch(e){console.error("Error syncing messages:",e)}finally{u(!1)}}},[e,S]),C=(0,a.useCallback)(async e=>{i(e);let r=t.find(t=>t.id===e);if(r&&!r.is_read)try{await fetch(`/api/inbox/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_read:!0})}),s(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(e){console.error("Error marking message as read:",e)}},[t]),P=(0,a.useCallback)(async e=>{if(n){x(!0);try{let t=await fetch(`/api/inbox/${n}/reply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(t.ok){let e=await t.json();s(t=>t.map(t=>t.id===n?{...t,replied_at:e.data.replied_at}:t)),w&&i(n)}}catch(e){console.error("Error sending reply:",e)}finally{x(!1)}}},[n,w]),E=(0,a.useCallback)(async e=>{if(n)try{(await fetch(`/api/inbox/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_read:e})})).ok&&s(t=>t.map(t=>t.id===n?{...t,is_read:e}:t))}catch(e){console.error("Error updating message:",e)}},[n]),A=(0,a.useCallback)(async e=>{if(n)try{(await fetch(`/api/inbox/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_resolved:e})})).ok&&s(t=>t.map(t=>t.id===n?{...t,is_resolved:e}:t))}catch(e){console.error("Error updating message:",e)}},[n]),T=t.filter(e=>{if(h){let t=h.toLowerCase();if(!e.content.toLowerCase().includes(t)&&!e.sender_name.toLowerCase().includes(t))return!1}return(!g||e.platform===g)&&("read"!==j||!!e.is_read)&&("unread"!==j||!e.is_read)&&("resolved"!==k||!!e.is_resolved)&&("unresolved"!==k||!e.is_resolved)}),F=t.filter(e=>!e.is_read).length;return e?0!==t.length||o?(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[r.jsx(M,{onSearch:b,onFilterPlatform:v,onFilterReadStatus:y,onFilterResolved:N,onSync:R,unreadCount:F,isSyncing:c,searchQuery:h,activePlatformFilter:g,activeReadFilter:j,activeResolvedFilter:k}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[r.jsx("div",{className:"hidden md:flex md:w-1/3 h-full flex-col",children:r.jsx(p,{messages:T,selectedId:n,onSelect:C,isLoading:o})}),r.jsx("div",{className:"w-full md:w-2/3 h-full",children:n?r.jsx(_,{message:w,onReply:P,onMarkRead:E,onMarkResolved:A,isReplying:f}):r.jsx("div",{className:"hidden md:flex items-center justify-center h-full bg-white dark:bg-slate-950",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(m,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-3"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"No message selected"}),r.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-xs mt-1",children:"Select a message from the list to view details"})]})})}),r.jsx("div",{className:"md:hidden w-full h-full",children:n?r.jsx(_,{message:w,onReply:P,onMarkRead:E,onMarkResolved:A,isReplying:f}):r.jsx(p,{messages:T,selectedId:n,onSelect:C,isLoading:o})})]})]}):(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[r.jsx(M,{onSearch:b,onFilterPlatform:v,onFilterReadStatus:y,onFilterResolved:N,onSync:R,unreadCount:F,isSyncing:c,searchQuery:h,activePlatformFilter:g,activeReadFilter:j,activeResolvedFilter:k}),r.jsx("div",{className:"flex items-center justify-center flex-1",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(m,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-3"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"No messages yet"}),r.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-xs mt-1",children:"Connect your social accounts to start receiving messages"})]})})]}):r.jsx("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(m,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-3"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Select a brand to view messages"})]})})}},3594:(e,t,s)=>{"use strict";s.d(t,{F$:()=>i,Q5:()=>o,qE:()=>n});var r=s(326),a=s(7577),l=s(1223);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("relative inline-flex h-10 w-10 shrink-0 overflow-hidden rounded-full bg-slate-100 dark:bg-slate-800",e),...t}));n.displayName="Avatar";let i=a.forwardRef(({className:e,alt:t,...s},a)=>r.jsx("img",{ref:a,alt:t,className:(0,l.cn)("aspect-square h-full w-full object-cover",e),...s}));i.displayName="AvatarImage";let o=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center bg-slate-200 text-xs font-medium text-slate-600 dark:bg-slate-700 dark:text-slate-200",e),...t}));o.displayName="AvatarFallback"},8443:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var r=s(326);s(7577);var a=s(9360),l=s(1223);let n=(0,a.j)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border border-transparent bg-brand-500 text-white hover:bg-brand-600",secondary:"border border-transparent bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-50 dark:hover:bg-slate-700",destructive:"border border-transparent bg-red-500 text-white hover:bg-red-600",outline:"border border-slate-200 text-slate-950 dark:border-slate-800 dark:text-slate-50"}},defaultVariants:{variant:"default"}});function i({className:e,variant:t,...s}){return r.jsx("div",{className:(0,l.cn)(n({variant:t}),e),...s})}},1664:(e,t,s)=>{"use strict";s.d(t,{z:()=>o});var r=s(326),a=s(7577),l=s(9360),n=s(1223);let i=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand-500 text-white hover:bg-brand-600 active:bg-brand-700",destructive:"bg-red-500 text-white hover:bg-red-600 active:bg-red-700",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 active:bg-secondary/70",ghost:"hover:bg-accent hover:text-accent-foreground active:bg-accent/70",link:"text-brand-500 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef(({className:e,variant:t,size:s,...a},l)=>r.jsx("button",{className:(0,n.cn)(i({variant:t,size:s,className:e})),ref:l,...a}));o.displayName="Button"},143:(e,t,s)=>{"use strict";s.d(t,{$F:()=>d,AW:()=>c,Xi:()=>u,h_:()=>o});var r=s(326),a=s(7577),l=s(1223);let n=a.createContext(void 0);function i(){let e=a.useContext(n);if(!e)throw Error("DropdownMenu components must be used within DropdownMenu");return e}function o({children:e,open:t,onOpenChange:s}){let l=a.useRef(null),[i,o]=a.useState(!1);return r.jsx(n.Provider,{value:{open:void 0!==t?t:i,setOpen:e=>{void 0===t&&o(e),s?.(e)},triggerRef:l},children:e})}let d=a.forwardRef(({onClick:e,...t},s)=>{let{open:a,setOpen:l,triggerRef:n}=i();return r.jsx("button",{ref:e=>{n.current=e,"function"==typeof s?s(e):s&&(s.current=e)},onClick:t=>{l(!a),e?.(t)},...t})});d.displayName="DropdownMenuTrigger";let c=a.forwardRef(({className:e,...t},s)=>{let{open:n,setOpen:o,triggerRef:d}=i(),[c,u]=a.useState({top:0,left:0}),m=a.useRef(null);return(a.useEffect(()=>{if(n&&d.current){let e=d.current.getBoundingClientRect();u({top:e.bottom+8,left:e.left})}},[n,d]),a.useEffect(()=>{if(!n)return;let e=e=>{!m.current||m.current.contains(e.target)||d.current?.contains(e.target)||o(!1)},t=e=>{"Escape"===e.key&&o(!1)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[n,o,d]),n)?r.jsx("div",{ref:s,style:{position:"fixed",top:`${c.top}px`,left:`${c.left}px`,zIndex:50},className:(0,l.cn)("min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white p-1 shadow-md dark:border-slate-800 dark:bg-slate-950",e),...t}):null});c.displayName="DropdownMenuContent";let u=a.forwardRef(({className:e,onClick:t,...s},a)=>{let{setOpen:n}=i();return r.jsx("button",{ref:a,className:(0,l.cn)("relative flex w-full cursor-pointer select-none items-center rounded px-2 py-1.5 text-sm outline-none hover:bg-slate-100 focus:bg-slate-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:hover:bg-slate-800 dark:focus:bg-slate-800",e),onClick:e=>{n(!1),t?.(e)},...s})});u.displayName="DropdownMenuItem"},1190:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var r=s(326),a=s(7577),l=s(1223);let n=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));n.displayName="Input"},384:(e,t,s)=>{"use strict";s.d(t,{SP:()=>c,dr:()=>d,mQ:()=>o,nU:()=>u});var r=s(326),a=s(7577),l=s(1223);let n=a.createContext(void 0);function i(){let e=a.useContext(n);if(!e)throw Error("Tabs components must be used within Tabs");return e}function o({children:e,defaultValue:t,value:s,onValueChange:l}){let[i,o]=a.useState(t);return r.jsx(n.Provider,{value:{activeTab:void 0!==s?s:i,setActiveTab:e=>{void 0===s&&o(e),l?.(e)}},children:e})}let d=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-slate-100 p-1 text-slate-500 dark:bg-slate-800 dark:text-slate-400",e),...t}));d.displayName="TabsList";let c=a.forwardRef(({className:e,value:t,onClick:s,...a},n)=>{let{activeTab:o,setActiveTab:d}=i(),c=o===t;return r.jsx("button",{ref:n,onClick:e=>{d(t),s?.(e)},className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c?"bg-white text-slate-950 shadow-sm dark:bg-slate-950 dark:text-slate-50":"text-slate-600 hover:text-slate-950 dark:text-slate-400 dark:hover:text-slate-50",e),...a})});c.displayName="TabsTrigger";let u=a.forwardRef(({className:e,value:t,...s},a)=>{let{activeTab:n}=i();return n!==t?null:r.jsx("div",{ref:a,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s})});u.displayName="TabsContent"},2015:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var r=s(326),a=s(7577),l=s(1223);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));n.displayName="Textarea"},1223:(e,t,s)=>{"use strict";s.d(t,{SY:()=>o,S_:()=>d,cn:()=>l,p6:()=>n,uf:()=>i});var r=s(1135),a=s(1009);function l(...e){return(0,a.m6)((0,r.W)(e))}function n(e,t){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",...t}).format(new Date(e))}function i(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}function o(e){let t=Math.floor((Date.now()-new Date(e).getTime())/6e4);if(t<1)return"just now";if(t<60)return`${t}m ago`;let s=Math.floor(t/60);if(s<24)return`${s}h ago`;let r=Math.floor(s/24);return r<7?`${r}d ago`:n(e)}function d(e){return({facebook:"#1877F2",instagram:"#E4405F",tiktok:"#000000",youtube:"#FF0000",linkedin:"#0A66C2",google_business:"#4285F4"})[e]||"#6B7280"}},5436:(e,t,s)=>{"use strict";s.d(t,{o:()=>r});let r=(0,s(8408).U)((e,t)=>({brands:[],activeBrandId:null,accounts:[],setBrands:t=>e({brands:t}),setActiveBrand:t=>e({activeBrandId:t}),setAccounts:t=>e({accounts:t}),getActiveBrand:()=>{let{brands:e,activeBrandId:s}=t();return e.find(e=>e.id===s)}}))},2580:(e,t,s)=>{"use strict";s.d(t,{L:()=>r});let r=(0,s(8408).U)(e=>({user:null,isLoading:!0,setUser:t=>e({user:t,isLoading:!1}),setLoading:t=>e({isLoading:t})}))},8585:(e,t,s)=>{"use strict";var r=s(1085);s.o(r,"redirect")&&s.d(t,{redirect:function(){return r.redirect}})},1085:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{ReadonlyURLSearchParams:function(){return n},RedirectType:function(){return r.RedirectType},notFound:function(){return a.notFound},permanentRedirect:function(){return r.permanentRedirect},redirect:function(){return r.redirect}});let r=s(3953),a=s(6399);class l extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class n extends URLSearchParams{append(){throw new l}delete(){throw new l}set(){throw new l}sort(){throw new l}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{isNotFoundError:function(){return a},notFound:function(){return r}});let s="NEXT_NOT_FOUND";function r(){let e=Error(s);throw e.digest=s,e}function a(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===s}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return s}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(s||(s={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3953:(e,t,s)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{RedirectType:function(){return r},getRedirectError:function(){return o},getRedirectStatusCodeFromError:function(){return x},getRedirectTypeFromError:function(){return f},getURLFromRedirectError:function(){return m},isRedirectError:function(){return u},permanentRedirect:function(){return c},redirect:function(){return d}});let a=s(4580),l=s(2934),n=s(8586),i="NEXT_REDIRECT";function o(e,t,s){void 0===s&&(s=n.RedirectStatusCode.TemporaryRedirect);let r=Error(i);r.digest=i+";"+t+";"+e+";"+s+";";let l=a.requestAsyncStorage.getStore();return l&&(r.mutableCookies=l.mutableCookies),r}function d(e,t){void 0===t&&(t="replace");let s=l.actionAsyncStorage.getStore();throw o(e,t,(null==s?void 0:s.isAction)?n.RedirectStatusCode.SeeOther:n.RedirectStatusCode.TemporaryRedirect)}function c(e,t){void 0===t&&(t="replace");let s=l.actionAsyncStorage.getStore();throw o(e,t,(null==s?void 0:s.isAction)?n.RedirectStatusCode.SeeOther:n.RedirectStatusCode.PermanentRedirect)}function u(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,s,r,a]=e.digest.split(";",4),l=Number(a);return t===i&&("replace"===s||"push"===s)&&"string"==typeof r&&!isNaN(l)&&l in n.RedirectStatusCode}function m(e){return u(e)?e.digest.split(";",3)[2]:null}function f(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function x(e){if(!u(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6637:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/Users/tezferguson/gitProjects/onitsocial/src/app/(dashboard)/inbox/page.tsx#default`)},3028:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(9510),a=s(8585),l=s(5655);let n=(0,s(8570).createProxy)(String.raw`/Users/tezferguson/gitProjects/onitsocial/src/app/(dashboard)/(dashboard-client)/layout-client.tsx#DashboardLayoutClient`);async function i({children:e}){let t=await (0,l.f)(),{data:{session:s}}=await t.auth.getSession();s||(0,a.redirect)("/auth/login");let{data:i,error:o}=await t.from("users").select("*").eq("id",s.user.id).single();(o||!i)&&(0,a.redirect)("/auth/login");let{data:d}=await t.from("brands").select("*").eq("user_id",s.user.id),{data:c}=await t.from("connected_accounts").select("*");return r.jsx(n,{user:i,brands:d||[],accounts:c||[],children:e})}},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>a});var r=s(9510);s(5023);let a={title:"Onit - Social Media Management",description:"Manage all your social media brands from one dashboard. Schedule posts, track analytics, and manage your inbox across Facebook, Instagram, TikTok, YouTube, LinkedIn, and Google Business.",keywords:["social media management","scheduling","analytics","instagram","tiktok","facebook"]};function l({children:e}){return r.jsx("html",{lang:"en",className:"h-full",children:r.jsx("body",{className:"h-full font-sans",children:e})})}},5655:(e,t,s)=>{"use strict";s.d(t,{f:()=>l,k:()=>n});var r=s(7721),a=s(1615);async function l(){let e=await (0,a.cookies)();return(0,r.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:t=>e.get(t)?.value,set(t,s,r){try{e.set({name:t,value:s,...r})}catch{}},remove(t,s){try{e.set({name:t,value:"",...s})}catch{}}}})}async function n(){let{createClient:e}=await Promise.resolve().then(s.bind(s,7857));return e(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}},5023:()=>{},8408:(e,t,s)=>{"use strict";s.d(t,{U:()=>o});var r=s(7577);let a=e=>{let t;let s=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,l={setState:r,getState:a,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e))},n=t=e(r,a,l);return l},l=e=>e?a(e):a,n=e=>e,i=e=>{let t=l(e),s=e=>(function(e,t=n){let s=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},o=e=>e?i(e):i}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,9702,4471,6582],()=>s(1336));module.exports=r})();