"use strict";(()=>{var e={};e.id=7756,e.ids=[7756],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},85335:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>f});var r={};s.r(r),s.d(r,{GET:()=>u,POST:()=>d});var n=s(49303),o=s(88716),a=s(60670),i=s(87070),c=s(65655);let l=process.env.LATE_API_BASE_URL||"https://getlate.dev/api/v1",p={facebook:{list:"/connect/facebook/select-page",select:"/connect/facebook/select-page",itemKey:"pages"},linkedin:{list:"/connect/linkedin/organizations",select:"/connect/linkedin/select-organization",itemKey:"organizations"},googlebusiness:{list:"/connect/googlebusiness/locations",select:"/connect/googlebusiness/select-location",itemKey:"locations"},pinterest:{list:"/connect/pinterest/select-board",select:"/connect/pinterest/select-board",itemKey:"boards"}};async function u(e){try{let t=await (0,c.f)(),{data:{user:s},error:r}=await t.auth.getUser();if(r||!s)return i.NextResponse.json({error:"Unauthorized"},{status:401});let n=e.nextUrl.searchParams,o=n.get("profileId"),a=n.get("tempToken"),u=n.get("connectToken"),d=n.get("platform")?.toLowerCase();if(!o||!a||!u||!d)return i.NextResponse.json({error:"Missing required parameters"},{status:400});let g=p[d];if(!g)return i.NextResponse.json({error:`Unsupported platform: ${d}`},{status:400});let m=new URLSearchParams({profileId:o,tempToken:a}),f=await fetch(`${l}${g.list}?${m}`,{headers:{"X-Connect-Token":u}}),x=await f.json();if(!f.ok)return i.NextResponse.json({error:x.error||`Failed to fetch ${d} items`},{status:f.status});let h=x[g.itemKey]||x.pages||x.organizations||x.locations||x.boards||[];return i.NextResponse.json({[g.itemKey]:h})}catch(e){return console.error("GET /api/connections/select-items error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let t=await (0,c.f)(),{data:{user:s},error:r}=await t.auth.getUser();if(r||!s)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{profileId:n,itemId:o,tempToken:a,userProfile:u,connectToken:d,platform:g}=await e.json();if(!n||!o||!d||!g)return i.NextResponse.json({error:"Missing required parameters"},{status:400});let m=g.toLowerCase(),f=p[m];if(!f)return i.NextResponse.json({error:`Unsupported platform: ${g}`},{status:400});let x={profileId:n,tempToken:a,userProfile:u};"facebook"===m?x.pageId=o:"linkedin"===m?x.organizationId=o:"googlebusiness"===m?x.locationId=o:"pinterest"===m&&(x.boardId=o);let h=await fetch(`${l}${f.select}`,{method:"POST",headers:{"Content-Type":"application/json","X-Connect-Token":d},body:JSON.stringify(x)}),v=await h.json();if(!h.ok)return i.NextResponse.json({error:v.error||`Failed to select ${g} item`},{status:h.status});return i.NextResponse.json(v)}catch(e){return console.error("POST /api/connections/select-items error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let g=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/connections/select-items/route",pathname:"/api/connections/select-items",filename:"route",bundlePath:"app/api/connections/select-items/route"},resolvedPagePath:"/Users/tezferguson/gitProjects/onitsocial/src/app/api/connections/select-items/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:x}=g,h="/api/connections/select-items/route";function v(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:f})}},65655:(e,t,s)=>{s.d(t,{f:()=>o,k:()=>a});var r=s(67721),n=s(71615);async function o(){let e=await (0,n.cookies)();return(0,r.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:t=>e.get(t)?.value,set(t,s,r){try{e.set({name:t,value:s,...r})}catch{}},remove(t,s){try{e.set({name:t,value:"",...s})}catch{}}}})}async function a(){let{createClient:e}=await Promise.resolve().then(s.bind(s,37857));return e(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,9702,5972],()=>s(85335));module.exports=r})();