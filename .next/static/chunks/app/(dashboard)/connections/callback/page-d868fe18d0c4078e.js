(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{69918:function(e,t,r){Promise.resolve().then(r.bind(r,59436))},68755:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(2265);let a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},d=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:d="",children:u,iconNode:h,...f}=e;return(0,n.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:r,strokeWidth:i?24*Number(o)/Number(s):o,className:a("lucide",d),...!u&&!l(f)&&{"aria-hidden":"true"},...f},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,n.forwardRef)((r,o)=>{let{className:c,...l}=r;return(0,n.createElement)(d,{ref:o,iconNode:t,className:a("lucide-".concat(s(i(e))),"lucide-".concat(e),c),...l})});return r.displayName=i(e),r}},31047:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},96215:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},40875:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},49322:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},99801:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},25466:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},29985:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]])},15001:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},58293:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]])},99397:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},98728:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},15868:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},32489:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(68755).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},59436:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(57437),a=r(2265),s=r(99376),o=r(65640),i=r(79820),c=r(12381),l=r(15001);let d=(0,r(68755).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var u=r(49322);let h=["facebook","linkedin","googlebusiness","pinterest"];function f(){let e=(0,s.useSearchParams)(),t=(0,s.useRouter)(),[r,f]=(0,a.useState)(!0),[m,p]=(0,a.useState)(null),[x,y]=(0,a.useState)(null),[k,g]=(0,a.useState)(!1),[b,w]=(0,a.useState)([]),[j,v]=(0,a.useState)(null);async function N(e){try{let t=new URLSearchParams({profileId:e.profileId,tempToken:e.tempToken,connectToken:e.connectToken,platform:e.platform}),r=await fetch("/api/connections/select-items?".concat(t));if(!r.ok){let t=await r.json();throw Error(t.error||"Failed to fetch ".concat(e.platform," items"))}let n=await r.json(),a=n.pages||n.organizations||n.locations||n.boards||[];if(0===a.length){let t=e.platform.charAt(0).toUpperCase()+e.platform.slice(1);y("No ".concat(t," accounts found. Make sure you have admin access.")),f(!1);return}w(a),f(!1)}catch(e){console.error("Error fetching items:",e),y(e instanceof Error?e.message:"Failed to load accounts"),f(!1)}}async function C(e){if(j){p(e),y(null);try{let r=await fetch("/api/connections/select-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:j.profileId,itemId:e,tempToken:j.tempToken,userProfile:j.userProfile,connectToken:j.connectToken,platform:j.platform})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to connect account")}await S(j.profileId,j.platform),g(!0),window.opener?(window.opener.postMessage({type:"CONNECTION_SUCCESS",platform:j.platform},"*"),setTimeout(()=>window.close(),1500)):setTimeout(()=>{t.push("/brands?connected=".concat(j.platform))},2e3)}catch(e){console.error("Error selecting item:",e),y(e instanceof Error?e.message:"Failed to connect account"),p(null)}}}async function Z(e){try{await S(e.profileId,e.platform),g(!0),setTimeout(()=>{t.push("/brands?connected=".concat(e.platform))},2e3)}catch(e){y(e instanceof Error?e.message:"Failed to save connection"),f(!1)}}async function S(e,t){let r=await fetch("/api/connections/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:e,platform:t})});if(!r.ok)throw Error((await r.json()).error||"Failed to save connection")}if((0,a.useEffect)(()=>{var t;let r=e.get("step"),n=null===(t=e.get("platform"))||void 0===t?void 0:t.toLowerCase(),a=e.get("profileId"),s=e.get("tempToken"),o=e.get("connect_token"),i=e.get("userProfile");if(!a||!o||!n){y("Missing required OAuth parameters. Please try connecting again."),f(!1);return}let c={profileId:a,tempToken:s||"",connectToken:o,userProfile:i?JSON.parse(decodeURIComponent(i)):{},platform:n};v(c),("select_page"===r||"select_organization"===r||"select_location"===r||"select_board"===r)&&h.includes(n)?N(c):Z(c)},[e]),r)return(0,n.jsx)(o.r,{title:"Connecting...",children:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(l.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-brand-500"}),(0,n.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading available pages..."})]})})});if(k)return(0,n.jsx)(o.r,{title:"Connected!",children:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(d,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Successfully Connected!"}),(0,n.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Redirecting to your brand..."})]})})});if(x&&0===b.length)return(0,n.jsx)(o.r,{title:"Connection Error",children:(0,n.jsx)("div",{className:"max-w-md mx-auto mt-12 p-6",children:(0,n.jsx)(i.Zb,{className:"border-red-200 dark:border-red-800",children:(0,n.jsx)(i.aY,{className:"pt-6",children:(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(u.Z,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium text-red-700 dark:text-red-300 mb-2",children:"Connection Failed"}),(0,n.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:x}),(0,n.jsx)(c.z,{variant:"outline",className:"mt-4",onClick:()=>{window.opener?window.close():t.push("/connections")},children:window.opener?"Close":"Back to Connections"})]})]})})})})});let M=(null==j?void 0:j.platform)?j.platform.charAt(0).toUpperCase()+j.platform.slice(1):"Account",E=(null==j?void 0:j.platform)==="linkedin"?"Organization":(null==j?void 0:j.platform)==="googlebusiness"?"Location":(null==j?void 0:j.platform)==="pinterest"?"Board":"Page";return(0,n.jsx)(o.r,{title:"Connect ".concat(M),children:(0,n.jsx)("div",{className:"max-w-2xl mx-auto p-6",children:(0,n.jsxs)(i.Zb,{children:[(0,n.jsxs)(i.Ol,{className:"text-center",children:[(0,n.jsxs)(i.ll,{children:["Select a ",M," ",E]}),(0,n.jsxs)(i.SZ,{children:["Choose which ",E.toLowerCase()," you want to connect for posting"]})]}),(0,n.jsxs)(i.aY,{children:[x&&(0,n.jsx)("div",{className:"mb-4 p-3 rounded-lg bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-300 text-sm",children:x}),(0,n.jsx)("div",{className:"grid gap-3",children:b.map(e=>(0,n.jsx)("button",{onClick:()=>C(e.id),disabled:null!==m,className:"p-4 border-2 border-slate-200 dark:border-slate-700 rounded-lg hover:border-brand-500 hover:shadow-md transition-all text-left disabled:opacity-50",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-50",children:e.name}),e.username&&(0,n.jsxs)("p",{className:"text-sm text-brand-600 dark:text-brand-400",children:["@",e.username]}),(e.category||e.type)&&(0,n.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:e.category||e.type})]}),m===e.id&&(0,n.jsx)(l.Z,{className:"h-5 w-5 animate-spin text-brand-500"})]})},e.id))})]})]})})})}},79820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return o},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var n=r(57437),a=r(2265),s=r(93448);let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",r),...a})});o.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h2",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-slate-500 dark:text-slate-400",r),...a})});l.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},3011:function(e,t,r){"use strict";r.d(t,{U:function(){return c}});var n=r(2265);let a=e=>{let t;let r=new Set,n=(e,n)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=n?n:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,s={setState:n,getState:a,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e))},o=t=e(n,a,s);return s},s=e=>e?a(e):a,o=e=>e,i=e=>{let t=s(e),r=e=>(function(e,t=o){let r=n.useSyncExternalStore(e.subscribe,n.useCallback(()=>t(e.getState()),[e,t]),n.useCallback(()=>t(e.getInitialState()),[e,t]));return n.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},c=e=>e?i(e):i}},function(e){e.O(0,[569,648,640,971,117,744],function(){return e(e.s=69918)}),_N_E=e.O()}]);