(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{84723:function(e,s,t){Promise.resolve().then(t.bind(t,16613))},16613:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var a=t(57437),l=t(2265),r=t(49322),n=t(41473),d=t(7586),c=t(12381),i=t(56739),x=t(26062),o=t(70888),h=t(54405),m=t(71519),u=t(38549),j=t(8971),p=t(7768),b=t(6364),f=t(44779),N=t(6496),g=t(92451),k=t(10407),v=t(93448);function w(e){let{posts:s,onDaySelect:t,onPostClick:r,selectedDate:n}=e,[d,w]=(0,l.useState)(new Date),y=(0,l.useMemo)(()=>{let e=(0,i.N)(d),s=(0,x.V)(d),t=(0,o.D)({start:e,end:s}),a=e.getDay(),l=[];for(let s=a-1;s>=0;s--){let t=new Date(e);t.setDate(t.getDate()-(s+1)),l.push(t)}let r=s.getDay(),n=[];for(let e=1;e<7-r;e++){let t=new Date(s);t.setDate(t.getDate()+e),n.push(t)}return[...l.reverse(),...t,...n]},[d]),S=e=>{let t=(0,h.b)(e),a=(0,m.i)(e);return s.filter(e=>{if("scheduled"===e.status&&e.scheduled_for){let s=new Date(e.scheduled_for);return s>=t&&s<=a}if("published"===e.status&&e.published_at){let s=new Date(e.published_at);return s>=t&&s<=a}return!1})},C=e=>{let s=S(e),t=new Set;return s.forEach(e=>{e.platforms.forEach(e=>t.add(e))}),Array.from(t)},D=e=>{let s=S(e);null==t||t(e,s)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:(0,p.WU)(d,"MMMM yyyy")}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(c.z,{onClick:()=>{w((0,u.W)(d,1))},variant:"outline",size:"sm",className:"gap-1",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,a.jsx)(c.z,{onClick:()=>{w(new Date)},variant:"outline",size:"sm",children:"Today"}),(0,a.jsxs)(c.z,{onClick:()=>{w((0,j.z)(d,1))},variant:"outline",size:"sm",className:"gap-1",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,a.jsx)(k.Z,{className:"h-4 w-4"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 overflow-hidden",children:[(0,a.jsx)("div",{className:"grid grid-cols-7 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"p-2 sm:p-3 text-center text-xs sm:text-sm font-semibold text-slate-700 dark:text-slate-300",children:e},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7",children:y.map((e,s)=>{let t=(0,b.x)(e,d),l=(0,f.z)(e),r=n&&(0,N.K)(e,n),c=S(e),i=C(e);return(0,a.jsxs)("button",{onClick:()=>D(e),className:(0,v.cn)("aspect-square flex flex-col items-center justify-start p-1 sm:p-2 border-b border-r border-slate-200 dark:border-slate-800 text-xs sm:text-sm transition-colors hover:bg-slate-50 dark:hover:bg-slate-900/50",!t&&"bg-slate-50 dark:bg-slate-900/30 text-slate-400 dark:text-slate-600",l&&t&&"bg-blue-50 dark:bg-blue-950/30",r&&"bg-brand-100 dark:bg-brand-950/30 ring-2 ring-brand-500"),children:[(0,a.jsx)("span",{className:(0,v.cn)("font-semibold mb-1",l&&t&&"text-blue-600 dark:text-blue-400"),children:(0,p.WU)(e,"d")}),i.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-0.5 justify-center",children:[i.slice(0,3).map(e=>(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:(0,v.S_)(e)},title:e},e)),i.length>3&&(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 dark:bg-slate-600",title:"+".concat(i.length-3," more")})]}),c.length>0&&(0,a.jsxs)("div",{className:"mt-0.5 text-xs text-slate-600 dark:text-slate-400",children:[c.length," ",1===c.length?"post":"posts"]})]},s)})})]})]})}var y=t(99397),S=t(79820),C=t(83460);function D(e){let{date:s,posts:t,onBack:r,onAddPost:n,onEditPost:d,onDeletePost:i}=e,[x,o]=(0,l.useState)(new Set),h=t.filter(e=>!x.has(e.id)),m=e=>{o(s=>{let t=new Set(s);return t.add(e),t}),null==i||i(e)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-50 transition-colors",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Back"})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:(0,v.p6)(s)}),(0,a.jsxs)(c.z,{onClick:()=>null==n?void 0:n(s),size:"sm",className:"gap-2",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),"Add Post"]})]}),0===h.length?(0,a.jsx)(S.Zb,{children:(0,a.jsxs)(S.aY,{className:"p-8 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"No posts scheduled for this day"}),(0,a.jsxs)(c.z,{onClick:()=>null==n?void 0:n(s),className:"gap-2",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),"Create First Post"]})]})}):(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsx)(C.y,{post:e,onEdit:d,onDelete:m},e.id))}),h.length>0&&(0,a.jsx)(S.Zb,{children:(0,a.jsx)(S.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Posts"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.filter(e=>"published"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Published"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.filter(e=>"scheduled"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Scheduled"})]})]})})})]})}var z=t(31444),Z=t(9644),_=t(99376),E=t(51817);function P(){let{activeBrandId:e,getActiveBrand:s}=(0,Z.o)(),t=(0,_.useRouter)(),[i,x]=(0,l.useState)("calendar"),[o,h]=(0,l.useState)(null),[m,u]=(0,l.useState)([]),[j,p]=(0,l.useState)([]),[b,f]=(0,l.useState)(!0),N=s();(0,l.useEffect)(()=>{e||t.push("/dashboard")},[e,t]),(0,l.useEffect)(()=>{e&&(async()=>{f(!0);try{let s=await fetch("/api/posts?brandId=".concat(e,"&limit=500&offset=0"));if(!s.ok)throw Error("Failed to fetch posts");let t=await s.json();p(t.data||[])}catch(e){console.error("Error fetching posts:",e),p([])}finally{f(!1)}})()},[e]);let g=()=>{x("calendar"),h(null),u([])};return e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:"Content Calendar"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:(null==N?void 0:N.name)&&(0,a.jsxs)(a.Fragment,{children:["Manage your content schedule for ",(0,a.jsx)("span",{className:"font-semibold",children:N.name})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(c.z,{onClick:()=>x("calendar"),variant:"calendar"===i?"default":"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),"Calendar"]}),(0,a.jsxs)(c.z,{onClick:()=>x("list"),variant:"list"===i?"default":"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),"List"]})]})]}),b&&(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(E.Z,{className:"h-8 w-8 mx-auto text-slate-600 dark:text-slate-400 animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Loading calendar..."})]})}),!b&&(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:"calendar"===i?(0,a.jsx)(w,{posts:j,onDaySelect:(e,s)=>{h(e),u(s),"calendar"===i&&x("list")},selectedDate:o||void 0}):o?(0,a.jsx)(D,{date:o,posts:m,onBack:g,onAddPost:e=>{t.push("/planner")}}):(0,a.jsx)(z.p,{})}),"calendar"===i&&(0,a.jsx)("div",{className:"hidden lg:block sticky top-20",children:o?(0,a.jsx)(D,{date:o,posts:m,onBack:g,onAddPost:e=>{t.push("/planner")}}):(0,a.jsx)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6 text-center",children:(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Select a day to view and manage posts"})})})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(r.Z,{className:"h-12 w-12 mx-auto text-amber-600 dark:text-amber-400"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"No Brand Selected"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Please select a brand to view its calendar"})]})})}}},function(e){e.O(0,[851,769,733,444,971,117,744],function(){return e(e.s=84723)}),_N_E=e.O()}]);