(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{84723:function(e,s,t){Promise.resolve().then(t.bind(t,16613))},16613:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return M}});var a=t(57437),l=t(2265),r=t(49322),n=t(41473),d=t(7586),c=t(51817),i=t(65640),x=t(12381),o=t(56739),h=t(26062),m=t(70888),u=t(54405),j=t(71519),p=t(38549),b=t(8971),f=t(7768),N=t(6364),g=t(44779),k=t(6496),v=t(92451),w=t(10407),y=t(93448);function C(e){let{posts:s,onDaySelect:t,onPostClick:r,selectedDate:n}=e,[d,c]=(0,l.useState)(new Date),i=(0,l.useMemo)(()=>{let e=(0,o.N)(d),s=(0,h.V)(d),t=(0,m.D)({start:e,end:s}),a=e.getDay(),l=[];for(let s=a-1;s>=0;s--){let t=new Date(e);t.setDate(t.getDate()-(s+1)),l.push(t)}let r=s.getDay(),n=[];for(let e=1;e<7-r;e++){let t=new Date(s);t.setDate(t.getDate()+e),n.push(t)}return[...l.reverse(),...t,...n]},[d]),C=e=>{let t=(0,u.b)(e),a=(0,j.i)(e);return s.filter(e=>{if("scheduled"===e.status&&e.scheduled_for){let s=new Date(e.scheduled_for);return s>=t&&s<=a}if("published"===e.status&&e.published_at){let s=new Date(e.published_at);return s>=t&&s<=a}return!1})},S=e=>{let s=C(e),t=new Set;return s.forEach(e=>{e.platforms.forEach(e=>t.add(e))}),Array.from(t)},D=e=>{let s=C(e);null==t||t(e,s)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:(0,f.WU)(d,"MMMM yyyy")}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(x.z,{onClick:()=>{c((0,p.W)(d,1))},variant:"outline",size:"sm",className:"gap-1",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,a.jsx)(x.z,{onClick:()=>{c(new Date)},variant:"outline",size:"sm",children:"Today"}),(0,a.jsxs)(x.z,{onClick:()=>{c((0,b.z)(d,1))},variant:"outline",size:"sm",className:"gap-1",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,a.jsx)(w.Z,{className:"h-4 w-4"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 overflow-hidden",children:[(0,a.jsx)("div",{className:"grid grid-cols-7 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"p-2 sm:p-3 text-center text-xs sm:text-sm font-semibold text-slate-700 dark:text-slate-300",children:e},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7",children:i.map((e,s)=>{let t=(0,N.x)(e,d),l=(0,g.z)(e),r=n&&(0,k.K)(e,n),c=C(e),i=S(e);return(0,a.jsxs)("button",{onClick:()=>D(e),className:(0,y.cn)("aspect-square flex flex-col items-center justify-start p-1 sm:p-2 border-b border-r border-slate-200 dark:border-slate-800 text-xs sm:text-sm transition-colors hover:bg-slate-50 dark:hover:bg-slate-900/50",!t&&"bg-slate-50 dark:bg-slate-900/30 text-slate-400 dark:text-slate-600",l&&t&&"bg-blue-50 dark:bg-blue-950/30",r&&"bg-brand-100 dark:bg-brand-950/30 ring-2 ring-brand-500"),children:[(0,a.jsx)("span",{className:(0,y.cn)("font-semibold mb-1",l&&t&&"text-blue-600 dark:text-blue-400"),children:(0,f.WU)(e,"d")}),i.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-0.5 justify-center",children:[i.slice(0,3).map(e=>(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:(0,y.S_)(e)},title:e},e)),i.length>3&&(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 dark:bg-slate-600",title:"+".concat(i.length-3," more")})]}),c.length>0&&(0,a.jsxs)("div",{className:"mt-0.5 text-xs text-slate-600 dark:text-slate-400",children:[c.length," ",1===c.length?"post":"posts"]})]},s)})})]})]})}var S=t(99397),D=t(79820),z=t(83460);function Z(e){let{date:s,posts:t,onBack:r,onAddPost:n,onEditPost:d,onDeletePost:c}=e,[i,o]=(0,l.useState)(new Set),h=t.filter(e=>!i.has(e.id)),m=e=>{o(s=>{let t=new Set(s);return t.add(e),t}),null==c||c(e)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-50 transition-colors",children:[(0,a.jsx)(v.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Back"})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:(0,y.p6)(s)}),(0,a.jsxs)(x.z,{onClick:()=>null==n?void 0:n(s),size:"sm",className:"gap-2",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),"Add Post"]})]}),0===h.length?(0,a.jsx)(D.Zb,{children:(0,a.jsxs)(D.aY,{className:"p-8 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"No posts scheduled for this day"}),(0,a.jsxs)(x.z,{onClick:()=>null==n?void 0:n(s),className:"gap-2",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),"Create First Post"]})]})}):(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsx)(z.y,{post:e,onEdit:d,onDelete:m},e.id))}),h.length>0&&(0,a.jsx)(D.Zb,{children:(0,a.jsx)(D.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Posts"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.filter(e=>"published"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Published"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:h.filter(e=>"scheduled"===e.status).length}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Scheduled"})]})]})})})]})}var _=t(31444),E=t(9644),P=t(99376);function M(){let{activeBrandId:e,getActiveBrand:s}=(0,E.o)(),t=(0,P.useRouter)(),[o,h]=(0,l.useState)("calendar"),[m,u]=(0,l.useState)(null),[j,p]=(0,l.useState)([]),[b,f]=(0,l.useState)([]),[N,g]=(0,l.useState)(!0),k=s();(0,l.useEffect)(()=>{e||t.push("/dashboard")},[e,t]),(0,l.useEffect)(()=>{e&&(async()=>{g(!0);try{let s=await fetch("/api/posts?brandId=".concat(e,"&limit=500&offset=0"));if(!s.ok)throw Error("Failed to fetch posts");let t=await s.json();f(t.data||[])}catch(e){console.error("Error fetching posts:",e),f([])}finally{g(!1)}})()},[e]);let v=()=>{h("calendar"),u(null),p([])};return e?(0,a.jsx)(i.r,{title:"Calendar",subtitle:(null==k?void 0:k.name)?"Content schedule for ".concat(k.name):"Manage your content schedule",children:(0,a.jsxs)("div",{className:"space-y-6 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsxs)(x.z,{onClick:()=>h("calendar"),variant:"calendar"===o?"default":"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),"Calendar"]}),(0,a.jsxs)(x.z,{onClick:()=>h("list"),variant:"list"===o?"default":"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),"List"]})]}),N&&(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(c.Z,{className:"h-8 w-8 mx-auto text-slate-600 dark:text-slate-400 animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Loading calendar..."})]})}),!N&&(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:"calendar"===o?(0,a.jsx)(C,{posts:b,onDaySelect:(e,s)=>{u(e),p(s),"calendar"===o&&h("list")},selectedDate:m||void 0}):m?(0,a.jsx)(Z,{date:m,posts:j,onBack:v,onAddPost:e=>{t.push("/planner")}}):(0,a.jsx)(_.p,{})}),"calendar"===o&&(0,a.jsx)("div",{className:"hidden lg:block sticky top-20",children:m?(0,a.jsx)(Z,{date:m,posts:j,onBack:v,onAddPost:e=>{t.push("/planner")}}):(0,a.jsx)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6 text-center",children:(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Select a day to view and manage posts"})})})]})]})}):(0,a.jsx)(i.r,{title:"Calendar",subtitle:"Manage your content schedule",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh] p-6",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(r.Z,{className:"h-12 w-12 mx-auto text-amber-600 dark:text-amber-400"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"No Brand Selected"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Please select a brand to view its calendar"})]})})})}}},function(e){e.O(0,[569,648,291,133,640,444,971,117,744],function(){return e(e.s=84723)}),_N_E=e.O()}]);