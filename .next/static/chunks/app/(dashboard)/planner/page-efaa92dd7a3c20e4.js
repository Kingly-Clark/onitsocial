(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{41018:function(e,t,s){Promise.resolve().then(s.bind(s,57349))},68755:function(e,t,s){"use strict";s.d(t,{Z:function(){return u}});var a=s(2265);let l=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),i=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},o=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:x,...m}=e;return(0,a.createElement)("svg",{ref:t,...c,width:r,height:r,stroke:s,strokeWidth:i?24*Number(n)/Number(r):n,className:l("lucide",o),...!u&&!d(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{className:c,...d}=s;return(0,a.createElement)(o,{ref:n,iconNode:t,className:l("lucide-".concat(r(i(e))),"lucide-".concat(e),c),...d})});return s.displayName=i(e),s}},49322:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},71533:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},96362:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},51817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},83774:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},88893:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},18930:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(68755).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},99376:function(e,t,s){"use strict";var a=s(35475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},57349:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(57437),l=s(2265),r=s(49322),n=s(68755);let i=(0,n.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),c=(0,n.Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var d=s(83774);let o=(0,n.Z)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);var u=s(51817),x=s(12381),m=s(40279),h=s(23675),p=s(79820),f=s(69174),g=s(93448),b=s(9644),y=s(82566);let j={facebook:63206,instagram:2200,tiktok:2200,youtube:5e3,linkedin:3e3,google_business:2200};function v(e){let{onSuccess:t}=e,{activeBrandId:s,accounts:n}=(0,b.o)(),v=(0,l.useRef)(null),[k,N]=(0,l.useState)([]),[w,C]=(0,l.useState)({}),[S,Z]=(0,l.useState)([]),[P,M]=(0,l.useState)(""),[E,O]=(0,l.useState)(!1),[z,R]=(0,l.useState)(""),[A,I]=(0,l.useState)("09:00"),[L,_]=(0,l.useState)("draft"),[T,V]=(0,l.useState)(!1),[q,W]=(0,l.useState)(!1),[U,D]=(0,l.useState)(null),[F,H]=(0,l.useState)([]),B=n.map(e=>e.platform).filter((e,t,s)=>s.indexOf(e)===t),$=()=>k.some(e=>(T?w[e]||"":w[k[0]]||"").length>j[e]),G=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},J=e=>{T?C(t=>({...t,[k[0]]:e})):C(t=>({...t,[k[0]]:e}))},Y=e=>{e&&Array.from(e).forEach(e=>{if(!e.type.startsWith("image/")&&!e.type.startsWith("video/")){D({type:"error",text:"Only image and video files are supported"});return}let t=URL.createObjectURL(e);H(e=>[...e,t]),Z(e=>[...e,t])})},K=e=>{H(t=>t.filter((t,s)=>s!==e)),Z(t=>t.filter((t,s)=>s!==e))},Q=async()=>{if(!s||0===k.length){D({type:"error",text:"Select platforms to publish to"});return}let e=w[k[0]]||"";if(!e.trim()){D({type:"error",text:"Add content to your post"});return}if($()){D({type:"error",text:"Content exceeds character limit for selected platform(s)"});return}W(!0),D(null);try{let a=T?{...w}:k.reduce((t,s)=>(t[s]=e,t),{}),l="draft",r=null;"publish"===L?l="published":"scheduled"===L&&(l="scheduled",r="".concat(z,"T").concat(A,":00"));let n=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brandId:s,content:a,mediaUrls:S,platforms:k,status:l,scheduledFor:r,location:P||null})});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to create post")}D({type:"success",text:"publish"===L?"Post published successfully!":"scheduled"===L?"Post scheduled successfully!":"Post saved as draft!"}),N([]),C({}),Z([]),H([]),M(""),O(!1),R(""),I("09:00"),_("draft"),V(!1),null==t||t()}catch(e){D({type:"error",text:e instanceof Error?e.message:"Failed to create post"})}finally{W(!1)}},X=w[k[0]]||"";return(0,a.jsxs)(p.Zb,{className:"bg-white dark:bg-slate-950",children:[(0,a.jsx)(p.Ol,{children:(0,a.jsx)(p.ll,{children:"Compose Post"})}),(0,a.jsxs)(p.aY,{className:"space-y-6",children:[U&&(0,a.jsxs)("div",{className:(0,g.cn)("flex items-center gap-3 p-4 rounded-lg","success"===U.type?"bg-green-50 dark:bg-green-950 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-300"),children:["success"===U.type?(0,a.jsx)(i,{className:"h-5 w-5 flex-shrink-0"}):(0,a.jsx)(r.Z,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:U.text})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Select Platforms"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-6",children:y.VT.map(e=>{let t=B.includes(e.id),s=k.includes(e.id);return(0,a.jsx)("button",{onClick:()=>t&&G(e.id),disabled:!t,className:(0,g.cn)("relative flex items-center justify-center gap-2 rounded-lg border-2 p-3 transition-all",s?"border-slate-900 dark:border-slate-50 bg-slate-50 dark:bg-slate-900":"border-slate-200 dark:border-slate-800",!t&&"opacity-50 cursor-not-allowed"),title:t?"":"Not connected",children:(0,a.jsx)("span",{className:"text-xs font-medium text-center",children:e.label})},e.id)})}),0===B.length&&(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"No connected platforms. Go to brand settings to connect."})]}),k.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-slate-50 dark:bg-slate-900",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Customize per platform"}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Different content for each platform"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>V(!T),className:(0,g.cn)("relative w-11 h-6 rounded-full transition-colors",T?"bg-brand-500":"bg-slate-200 dark:bg-slate-700"),children:(0,a.jsx)("div",{className:(0,g.cn)("absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform",T&&"translate-x-5")})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Content"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:[X.length," /"," ",j[k[0]]]}),X.length>j[k[0]]&&(0,a.jsx)(f.C,{variant:"destructive",children:"Over limit"})]})]}),(0,a.jsx)(h.g,{placeholder:"What's on your mind?",value:X,onChange:e=>J(e.target.value),className:"min-h-32 resize-none",maxLength:Math.max(...k.map(e=>j[e]))})]}),T&&k.length>1&&(0,a.jsxs)("div",{className:"space-y-3 pt-3 border-t border-slate-200 dark:border-slate-800",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Platform-specific content preview"}),(0,a.jsx)("div",{className:"grid gap-3",children:k.map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-1 p-2 rounded-lg bg-slate-50 dark:bg-slate-900",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:null===(t=y.VT.find(t=>t.id===e))||void 0===t?void 0:t.label}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400 line-clamp-2",children:w[e]||"(Same as default)"})]},e)})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Media (Images & Videos)"}),(0,a.jsxs)("div",{className:"rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-700 p-4",children:[(0,a.jsx)("input",{ref:v,type:"file",multiple:!0,accept:"image/*,video/*",onChange:e=>Y(e.target.files),className:"hidden"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.click()},className:"w-full flex items-center justify-center gap-2 py-6 hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors",children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Click to upload or drag files"})]})]}),F.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:F.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"w-full h-20 object-cover rounded-lg"}),(0,a.jsx)("button",{type:"button",onClick:()=>K(t),className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center rounded-lg transition-opacity",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"Remove"})})]},t))})]}),(0,a.jsxs)("div",{className:"grid gap-3 pt-3 border-t border-slate-200 dark:border-slate-800",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Location (Optional)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 text-slate-400"}),(0,a.jsx)(m.I,{placeholder:"Add location",value:P,onChange:e=>M(e.target.value),className:"flex-1"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(x.z,{type:"button",variant:"ghost",size:"sm",className:"gap-2",title:"Emoji picker (placeholder)",children:[(0,a.jsx)(o,{className:"h-4 w-4"}),"Emoji"]})})]}),E&&(0,a.jsx)("div",{className:"space-y-3 p-4 rounded-lg bg-slate-50 dark:bg-slate-900",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Date"}),(0,a.jsx)(m.I,{type:"date",value:z,onChange:e=>R(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-900 dark:text-slate-50",children:"Time"}),(0,a.jsx)(m.I,{type:"time",value:A,onChange:e=>I(e.target.value)})]})]})}),(0,a.jsx)("div",{className:"flex flex-col gap-3 pt-3 border-t border-slate-200 dark:border-slate-800",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x.z,{onClick:()=>{_("draft"),Q()},variant:"secondary",disabled:q||0===k.length,className:"flex-1 gap-2",children:[q&&"draft"===L&&(0,a.jsx)(u.Z,{className:"h-4 w-4 animate-spin"}),"Save Draft"]}),(0,a.jsxs)(x.z,{onClick:()=>{_("scheduled"),E?Q():O(!0)},variant:"outline",disabled:q||0===k.length,className:"gap-2",children:[q&&"scheduled"===L&&(0,a.jsx)(u.Z,{className:"h-4 w-4 animate-spin"}),"Schedule"]}),(0,a.jsxs)(x.z,{onClick:()=>{_("publish"),Q()},disabled:q||0===k.length||$(),className:"flex-1 gap-2",children:[q&&"publish"===L&&(0,a.jsx)(u.Z,{className:"h-4 w-4 animate-spin"}),"Post Now"]})]})})]})]})]})}var k=s(31444),N=s(99376);function w(){let{activeBrandId:e,getActiveBrand:t}=(0,b.o)(),s=(0,N.useRouter)(),[n,i]=(0,l.useState)(0),c=t();return((0,l.useEffect)(()=>{e||s.push("/dashboard")},[e,s]),e)?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:"Content Planner"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:(null==c?void 0:c.name)&&(0,a.jsxs)(a.Fragment,{children:["Create and schedule content for ",(0,a.jsx)("span",{className:"font-semibold",children:c.name})]})})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(v,{onSuccess:()=>{i(e=>e+1)}})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)("div",{className:"sticky top-20",children:(0,a.jsx)(k.p,{},n)})})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(r.Z,{className:"h-12 w-12 mx-auto text-amber-600 dark:text-amber-400"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"No Brand Selected"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Please select a brand to start planning content"})]})})}},40279:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var a=s(57437),l=s(2265),r=s(93448);let n=l.forwardRef((e,t)=>{let{className:s,type:l,...n}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},23675:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var a=s(57437),l=s(2265),r=s(93448);let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});n.displayName="Textarea"},3011:function(e,t,s){"use strict";s.d(t,{U:function(){return c}});var a=s(2265);let l=e=>{let t;let s=new Set,a=(e,a)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=a?a:"object"!=typeof l||null===l)?l:Object.assign({},t,l),s.forEach(s=>s(t,e))}},l=()=>t,r={setState:a,getState:l,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e))},n=t=e(a,l,r);return r},r=e=>e?l(e):l,n=e=>e,i=e=>{let t=r(e),s=e=>(function(e,t=n){let s=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},c=e=>e?i(e):i}},function(e){e.O(0,[851,444,971,117,744],function(){return e(e.s=41018)}),_N_E=e.O()}]);